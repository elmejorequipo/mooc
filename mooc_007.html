<!DOCTYPE html>
<!-- 
  MOOC: Dominando los Prompts - Versi√≥n Final con Diagn√≥stico JS
  ---------------------------------------------------------------------
  Esta versi√≥n incluye console.logs en el DOMContentLoaded para ayudar a
  diagnosticar por qu√© la p√°gina podr√≠a mostrarse en blanco.

  Facilitador: Lic. Luis Alfredo Andia Valverde
  Instituci√≥n: Universidad Salesiana de Bolivia
  Versi√≥n del C√≥digo: 3.1 
  √öltima Modificaci√≥n: [Fecha Actual]
-->
<html lang="es-BO" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Dominando los Prompts: IA para Docentes en Santa Cruz | USB</title>
    <!-- ... (Resto de las metaetiquetas, links a fuentes y CSS, JSON-LD id√©nticos a la versi√≥n anterior 'mooc_ultra_final_con_doctype_y_js_completo.html') ... -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">

    <style>
        /* --- ESTILOS CSS CONSOLIDADOS (Id√©nticos a 'mooc_ultra_final_con_doctype_y_js_completo.html') --- */
        /* ... (Todos los estilos :root, body, coverPage, module-header, sidebar-nav, video-container, etc., como en la versi√≥n anterior) ... */
         :root { /* ... (Definici√≥n de variables CSS id√©ntica a la anterior) ... */ 
            --color-primary-purple: #4A0072;
            --color-primary-purple-light: #6A0DAD;
            --color-accent-yellow: #FFB300; 
            --color-accent-yellow-light: #FFCA28;
            --color-text-dark: #212529;
            --color-text-light: #FFFFFF;
            --color-text-medium: #495057;
            --color-background-light: #f8f9fa;
            --color-background-module: #FFFFFF;
            --color-success: #198754;
            --color-warning-bg: #fff3cd; 
            --color-warning-text: #664d03; 
            --color-warning-border: #ffeeba; 
            --color-danger-bg: #f8d7da;
            --color-danger-text: #58151c;
            --color-danger-border: #f5c2c7;
            --color-info-bg: #cff4fc;
            --color-info-text: #055160;
            --color-info-border: #b6effb;
            --color-indigo-accent: #6366F1; 
            --color-indigo-dark: #4f46e5;

            --font-primary: 'Inter', sans-serif;
            --font-headings: 'Playfair Display', serif;
            --focus-ring-color: #0056b3;
        }
        *:focus-visible {
            outline: 3px solid var(--focus-ring-color) !important;
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.2);
        }
        body { font-family: var(--font-primary); line-height: 1.75; background-color: #eef0f2; color: var(--color-text-dark); margin:0; padding:0; scroll-behavior: smooth; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}

        /* PORTADA */
        #coverPage { background: linear-gradient(135deg, #1D2B64 0%, #3A1C71 50%, #24243E 100%); color: var(--color-text-light); overflow: hidden; background-size: 250% 250%; animation: coverGradientBG 30s ease infinite alternate; }
        @keyframes coverGradientBG { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
        #initiateModuleBtn { background-color: var(--color-accent-yellow); color: var(--color-text-dark); font-weight: 700; box-shadow: 0 5px 18px rgba(0,0,0, 0.2);}
        #initiateModuleBtn:hover { background-color: var(--color-accent-yellow-light); box-shadow: 0 7px 22px rgba(0,0,0, 0.25);}
        #coverPage .bg-white\/5 { background-color: rgba(255, 255, 255, 0.08); backdrop-filter: blur(12px); }
        #studentInfoForm input[type="text"] { background-color: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.4); caret-color: var(--color-accent-yellow-light); }
        #studentInfoForm input[type="text"]::placeholder { color: rgba(255, 255, 255, 0.7); }


        /* ESTRUCTURA DEL MODULO */
        .app-container { display: flex; flex-direction: column; min-height: 100vh; background-color: var(--color-background-module); max-width: 1200px; margin: 0 auto; box-shadow: 0 10px 35px rgba(0, 0, 0, 0.08); }
        .module-container { display: none; flex-grow: 1;} /* moduleContainer inicialmente oculto */


        /* CABECERA DEL MODULO CON VIDEO */
        .module-header { /* ... estilos como en la version anterior ... */ }
        
        /* BARRA DE PROGRESO */
        .progress-bar-container { /* ... */ }
        .progress-bar { /* ... */ }

        /* NAVEGACI√ìN LATERAL (SIDEBAR) */
        .sidebar-nav { /* ... (con !important para el background-color si es necesario anular Tailwind) ... */ }
        /* ... (todos los estilos del sidebar) ... */
        
        /* VIDEO EMBED (CORREGIDO Y FINAL) */
        .video-container { background-color: #222; /* ... */ }
        .video-thumbnail-overlay img { z-index: 1; }
        .video-thumbnail-overlay::before { z-index: 2; background-color: rgba(25, 15, 45, 0.65); }
        .video-play-button { z-index: 3; background-color: rgba(255, 255, 255, 0.25); backdrop-filter: blur(5px); }
        .video-thumbnail-overlay:hover .video-play-button { transform: scale(1.1); background-color: rgba(255, 255, 255, 0.35); }
        .video-thumbnail-overlay:hover::before { background-color: rgba(25, 15, 45, 0.8); }
        .video-thumbnail-overlay:hover img { transform: scale(1.03); }


        /* CONTENIDO PRINCIPAL, SECCIONES, ACTIVIDADES */
        /* ... (Todos los estilos de secciones, botones, inputs, feedback como en la versi√≥n anterior ) ... */
        .module-section, .interactive-activity { border-left: 8px solid var(--color-indigo-accent); }
        .activity-instruction strong.highlight { background-color: var(--color-accent-yellow-light); color: var(--color-text-dark); }
        .attempts-feedback { background-color: var(--color-info-bg); border: 1px solid var(--color-info-border); color: var(--color-info-text); }
        
        .quiz-option.selected { background-color: var(--color-info-bg) !important; border-color: var(--color-info-border) !important; color: var(--color-info-text) !important; font-weight: 600; }
        .quiz-option.correct { background-color: #d1e7dd !important; border-color: var(--color-success) !important; color: #0f5132 !important;}
        .quiz-option.incorrect { background-color: var(--color-danger-bg) !important; border-color: var(--color-danger-border) !important; color: var(--color-danger-text) !important;}

        .visually-hidden { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }
        .text-balance { text-wrap: balance; }
    </style>
</head>
<body>

    <!-- Cover Page HTML (Id√©ntico a versiones anteriores) -->
    <div id="coverPage" class="relative text-white overflow-hidden">
        <div class="cover-background-shapes">
            <div class="shape shape1"></div><div class="shape shape2"></div>
            <div class="shape shape3"></div><div class="shape shape4"></div>
        </div>
        <div class="cover-content relative z-10 flex flex-col items-center justify-center min-h-screen p-4 sm:p-8">
            <div class="text-center mb-10">
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-black leading-tight mb-4 tracking-tight text-balance" style="font-family: 'Playfair Display', serif; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                    Dominando los Prompts
                </h1>
                <p class="text-xl sm:text-2xl md:text-3xl font-light mb-8 opacity-90 text-shadow-sm text-balance">
                    IA para una Educaci√≥n Secundaria Creativa en <span class="font-semibold text-yellow-300">Santa Cruz de la Sierra</span>
                </p>
                <p class="text-md sm:text-lg max-w-xl mx-auto opacity-85 mb-12 leading-relaxed text-balance">
                    ¬°Hola, colega profe! Prep√°rate para potenciar tu ingenio y el de tus estudiantes. Este curso te dar√° las claves para convertirte en un "maestro pronteador" con IA.
                </p>
            </div>
            <div class="bg-white/5 backdrop-blur-lg p-6 sm:p-10 rounded-xl shadow-2xl w-full max-w-md transform hover:scale-102 transition-transform duration-300">
                <h2 id="formHeading" class="text-2xl font-semibold mb-6 text-center text-yellow-300 text-balance">¬°Bienvenido/a! Ingresa tus datos para comenzar esta aventura:</h2>
                <form id="studentInfoForm" class="space-y-5" aria-labelledby="formHeading">
                    <div>
                        <label for="studentFirstName" class="block text-sm font-medium mb-1.5 opacity-80">Nombres:</label>
                        <input type="text" id="studentFirstName" name="studentFirstName" required autocomplete="given-name"
                               class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition placeholder-gray-300 text-white text-lg"
                               placeholder="Ej: Ana Sof√≠a">
                    </div>
                    <div>
                        <label for="studentLastName" class="block text-sm font-medium mb-1.5 opacity-80">Apellidos:</label>
                        <input type="text" id="studentLastName" name="studentLastName" required autocomplete="family-name"
                               class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition placeholder-gray-300 text-white text-lg"
                               placeholder="Ej: P√©rez L√≥pez">
                    </div>
                    <div>
                        <label for="studentClassCourse" class="block text-sm font-medium mb-1.5 opacity-80">Unidad Educativa / Curso que dictas:</label>
                        <input type="text" id="studentClassCourse" name="studentClassCourse" required autocomplete="organization-title"
                               class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition placeholder-gray-300 text-white text-lg"
                               placeholder="Ej: UE Don Bosco / 5to Secundaria - Lenguaje">
                    </div>
                    <button type="button" id="initiateModuleBtn"
                            class="w-full font-bold py-3.5 px-6 rounded-lg shadow-lg hover:bg-yellow-300 transform hover:scale-105 transition duration-300 ease-in-out mt-8 text-lg">
                        ¬°Ingresar al M√≥dulo!
                    </button>
                </form>
            </div>
             <p class="mt-12 text-xs opacity-60">¬© 2025 Plataforma Educativa Innovadora - Universidad Salesiana de Bolivia</p>
        </div>
    </div>

    <!-- Main Module Container HTML (Id√©ntico, aqu√≠ va TODO el contenido del curso) -->
    <div id="moduleContainer" class="module-container" style="display: none;"> <!-- Inicia oculto, JS lo maneja -->
        <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-labelledby="globalScoreLabel">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <span id="globalScoreLabel" class="visually-hidden">Progreso general del curso</span>

        <div class="flex flex-col lg:flex-row app-container">
            <aside class="sidebar-nav hidden lg:block" aria-label="Navegaci√≥n principal del m√≥dulo">
                <h3>Navegaci√≥n del M√≥dulo</h3>
                <ul id="sidebarNavList">
                    <!-- (Lista de enlaces del sidebar completa) -->
                    <li><a href="#welcomeSection" class="active">üëã Bienvenida Cruce√±a</a></li>
                    <li><a href="#objectivesSection">üéØ Objetivos Clave</a></li>
                    <li><a href="#section-intro-prompts">üí° ¬øQu√© es un Prompt?</a></li>
                    <!-- ... todos los dem√°s items del sidebar ... -->
                    <li><a href="#bibliographySection">üìö Recursos para Seguir Explorando</a></li>
                </ul>
                <div class="facilitator-info">
                     <p>Facilitador: <span class="font-semibold">Lic. Luis Alfredo Andia Valverde</span></p>
                    <p>M√≥dulo: <span class="font-semibold">Planificaci√≥n Educativa con IA</span></p>
                    <p>Instituci√≥n: <span class="font-semibold">Universidad Salesiana de Bolivia</span></p>
                    <p class="mt-4">Tu Progreso: <strong id="globalScore" class="font-bold text-blue-700">0%</strong></p>
                </div>
            </aside>

            <main class="main-content flex-grow p-5 lg:p-8" role="main">
                <header class="module-header rounded-lg mb-8 p-6 text-center shadow-lg">
                    <h1 class="text-balance">¬°Hola, <span class="student-name-placeholder text-yellow-300">Profe</span>! Bienvenido/a a "Dominando los Prompts"</h1>
                    <p class="text-balance">Aqu√≠ empieza tu viaje para convertir la IA en tu mejor aliada en el aula. ¬°Vamos a prontear como campeones!</p>
                    <div class="video-container mt-6">
                        <div class="video-thumbnail-overlay" data-video-id="REEMPLAZAR_CON_VIDEO_ID_YOUTUBE" data-thumbnail-url="https://img.youtube.com/vi/REEMPLAZAR_CON_VIDEO_ID_YOUTUBE/hqdefault.jpg"> 
                            <img src="https://img.youtube.com/vi/REEMPLAZAR_CON_VIDEO_ID_YOUTUBE/hqdefault.jpg" alt="Video Thumbnail: Introducci√≥n al Dise√±o de Prompts con IA.">
                            <div class="video-play-button" aria-label="Reproducir video introductorio"><span aria-hidden="true">‚ñ∂</span></div>
                        </div>
                        <iframe id="youtubeVideo" title="Video Introductorio al Dise√±o de Prompts con IA" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: none;"></iframe>
                    </div>
                </header>

                <!-- AQUI VA EL RESTO DEL CONTENIDO DEL CURSO (TODAS LAS SECCIONES Y ACTIVIDADES) -->
                <!-- Copia aqu√≠ TODO el contenido HTML desde <section id="welcomeSection"... hasta </section> de bibliographySection
                     de la versi√≥n `mooc_ultra_final_con_doctype_y_js_completo.html` o tu versi√≥n m√°s completa de contenido.
                     Esto es fundamental. Sin este contenido, la p√°gina seguir√° en blanco dentro del #moduleContainer.
                -->
                <section id="welcomeSection" class="module-section reveal-on-scroll" data-section-id="welcomeSection" aria-labelledby="welcomeHeading">
                    <h2 id="welcomeHeading" class="text-balance">üëã ¬°Bienvenida a la Revoluci√≥n del Prompt, <span class="student-name-placeholder text-indigo-600">Estimado/a Colega</span>!</h2>
                    <p>¬°Qu√© alegr√≠a tenerte aqu√≠, <span class="student-name-placeholder"></span>! Desde la vibrante Santa Cruz de la Sierra, te damos la bienvenida a este espacio de aprendizaje donde vamos a desmitificar la Inteligencia Artificial y convertirla en una herramienta poderosa para tu labor docente.</p>
                    <!-- ... resto del contenido de welcomeSection ... -->
                    <button class="mark-as-read-btn" data-section-id="welcomeSection" onclick="markSectionAsRead(this)">Marcar como le√≠do</button>
                </section>
                <!-- (REPETIR PARA TODAS LAS SECCIONES Y ACTIVIDADES) -->


            </main>
        </div>
    </div>

    <!-- Bot√≥n Volver Arriba y Modal (Id√©nticos) -->
    <a href="#" class="back-to-top" id="backToTopBtn" style="display:flex;" aria-label="Volver arriba"><span aria-hidden="true">‚¨ÜÔ∏è</span><span class="visually-hidden">Volver al inicio de la p√°gina</span></a>
    <div id="customModal" class="modal" role="alertdialog" aria-labelledby="modalTitle" aria-describedby="modalMessage" aria-modal="true" style="display: none;"><div class="modal-content"><h3 id="modalTitle" class="text-balance"></h3><p id="modalMessage"></p><button id="modalCloseBtn">¬°Entendido!</button></div></div>

    <script>
    // --- SCRIPT JS COMPLETO CON DIAGN√ìSTICO Y ESTRUCTURA FINAL ---

    // --- CONFIGURACI√ìN GLOBAL Y CONSTANTES ---
    const STORAGE_KEY_STUDENT_INFO = 'moocStudentInfo_prompts_SCZ_final_diag_v1'; // Key actualizada
    const STORAGE_KEY_PROGRESS = 'moocProgress_prompts_SCZ_final_diag_v1';   // Key actualizada
    const MAX_ATTEMPTS = 2;

    let studentInfo = { firstName: "", lastName: "", classCourse: "" };
    const completedSections = new Set();

    // --- Datos para Actividades Interactivas (Esqueleto, deben completarse) ---
    const quizQuestionsData = [
        { qId: "q1", correctValue: "b", feedbackCorrect: "¬°Exacto, [Estudiante]! La claridad y especificidad son la clave.", feedbackIncorrect: "No del todo. La claridad y el contexto son m√°s cruciales." },
        { qId: "q2", correctValue: "b", feedbackCorrect: "¬°As√≠ se hace, [Estudiante]! Esos son los ingredientes.", feedbackIncorrect: "Un buen prompt creativo necesita m√°s. Piensa en rol y contexto." },
        { qId: "q3", correctValue: "c", feedbackCorrect: "¬°Correct√≠simo, [Estudiante]! Iterar es probar y ajustar.", feedbackIncorrect: "Iterar es un proceso de mejora continua, no solo repetir o copiar." }
    ];
    const exerciseKeywords = ["charla", "perseverancia", "desaf√≠os", "estudiantes", "secundaria", "santa cruz", "tono", "anecdota", "motivacional", "resiliencia"];
    const exerciseMinLength = 70;
    
    const problemSolvingKeywords = ["abp", "turismo", "sostenible", "lomas de arena", "preguntas guia", "fases", "productos finales"];
    const problemSolvingMinLength = 80;

    const promptConstructionParts = ["promptRole", "promptTask", "promptContext", "promptFormatTone"];
    const promptConstructionMinLengths = [10, 10, 20, 15];

    const yourTurnKeywords = ["feria", "ciencias", "innovaci√≥n", "tradici√≥n", "camba", "stands", "interactivos"];
    const yourTurnMinLength = 60;

    const matchingPairsData = [ 
        { questionId: "match1", correctAnswer: "b", concept: "Rol de la IA" }, 
        { questionId: "match2", correctAnswer: "b", concept: "Formato de Salida Espec√≠fico" }, 
        { questionId: "match3", correctAnswer: "c", concept: "Restricci√≥n o L√≠mite Importante" } 
    ];
    const trueFalseQuestionsData = [
        { qId: "tf1", correctValue: "false", feedbackCorrect: "¬°Falso y bien visto, [Estudiante]! Claridad > longitud.", feedbackIncorrect: "En realidad, es falso. Precisi√≥n es mejor que longitud excesiva." },
        { qId: "tf2", correctValue: "true", feedbackCorrect: "¬°Verdadero! El tono es un ingrediente poderoso, [Estudiante].", feedbackIncorrect: "¬°Ojo! El tono s√≠ influye mucho en el estilo de la IA." },
        { qId: "tf3", correctValue: "false", feedbackCorrect: "¬°Falso! Las IAs modernas son multimodales, [Estudiante].", feedbackIncorrect: "¬°Incorrecto! Las IAs modernas pueden generar im√°genes, c√≥digo, etc." }
    ];

    // --- FUNCIONES DE UTILIDAD ---
    function updateStudentNamePlaceholders() { /* ... (Id√©ntica a la versi√≥n anterior) ... */ }
    function showCustomModal(title, message, type = 'info') { /* ... (Id√©ntica) ... */ }
    function closeModal() { /* ... (Id√©ntica) ... */ }

    // --- INICIALIZACI√ìN Y FLUJO PRINCIPAL ---
    function loadStudentInfo() { /* ... (Id√©ntica, usando STORAGE_KEY_STUDENT_INFO) ... */ }
    function initiateModule() { /* ... (Id√©ntica, usando STORAGE_KEY_STUDENT_INFO y showCustomModal) ... */ }
    function startModuleVisuals() { /* ... (Id√©ntica) ... */ }
    
    // --- MANEJO DE PROGRESO ---
    function updateOverallProgress() { /* ... (Id√©ntica, incluyendo ARIA) ... */ }
    function markSectionAsRead(button) { /* ... (Id√©ntica) ... */ }
    
    function saveProgress() {
        const progressData = {
            completedSections: Array.from(completedSections),
            activities: {}
        };
        document.querySelectorAll('.interactive-activity').forEach(actEl => {
            const activityId = actEl.id;
            const activityData = {
                lastScore: actEl.dataset.lastScore || "0",
                attempts: actEl.dataset.attempts || "0",
                attempted: actEl.dataset.attempted === "true",
                selections: {}, // Para quizzes, matching, true/false
                promptText: ""   // Para textareas
            };
            // L√≥gica espec√≠fica para guardar estado de cada tipo de actividad
            if (activityId === 'quizActivity') { /* ... (guardar opciones seleccionadas en activityData.selections) ... */ }
            else if (activityId === 'exerciseActivity' || activityId === 'problemSolvingActivity' || activityId === 'yourTurnToCreateActivity') {
                const textarea = actEl.querySelector('textarea');
                if (textarea) activityData.promptText = textarea.value;
            }
            // ... (A√±adir l√≥gica para `promptConstructionActivity`, `matchingActivity`, `trueFalseActivity`) ...
            progressData.activities[activityId] = activityData;
        });
        localStorage.setItem(STORAGE_KEY_PROGRESS, JSON.stringify(progressData));
    }

    function loadProgress() {
        const savedProgress = localStorage.getItem(STORAGE_KEY_PROGRESS);
        if (!savedProgress) {
            updateOverallProgress(); // Inicializa si no hay progreso guardado
            return;
        }
        const progressData = JSON.parse(savedProgress);
        if (progressData.completedSections) {
            progressData.completedSections.forEach(id => completedSections.add(id));
            document.querySelectorAll('.mark-as-read-btn').forEach(btn => {
                if (completedSections.has(btn.dataset.sectionId)) {
                    btn.classList.add('completed');
                    btn.innerHTML = 'Completado <span role="img" aria-label="check">‚úÖ</span>';
                    btn.disabled = true;
                }
            });
        }
        if (progressData.activities) {
            for (const activityId in progressData.activities) {
                const actEl = document.getElementById(activityId);
                const data = progressData.activities[activityId];
                if (actEl && data) {
                    actEl.dataset.lastScore = data.lastScore;
                    actEl.dataset.attempts = data.attempts;
                    actEl.dataset.attempted = data.attempted;
                    // L√≥gica para restaurar estado de inputs/selections si es necesario
                }
            }
        }
        updateOverallProgress();
    }
    
    // --- L√ìGICA GEN√âRICA DE MANEJO DE ACTIVIDADES ---
    function handleActivityAttemptEnhanced(activityElement, submitButton, resetButton, attemptsFeedbackElement, maxAttempts, evaluationLogic) { /* ... (Implementaci√≥n COMPLETA como en la versi√≥n anterior) ... */ }
    function handleActivityReset(activityElement, submitButton, resetButton, inputElementsSelectors, feedbackElementsSelectors, optionClassesToRemove = []) { /* ... (Implementaci√≥n COMPLETA) ... */ }

    // --- IMPLEMENTACI√ìN DETALLADA DE CADA ACTIVIDAD (Esqueleto - ¬°COMPLETAR `evaluationLogic`!) ---
    // Ejemplo para QuizActivity
    if (document.getElementById('quizActivity')) {
        // ... (Event listener para seleccionar opciones y submit/reset, como en `mooc_ultra_final_con_doctype_y_js_completo.html`) ...
        // Recuerda, la parte m√°s importante aqu√≠ es definir una `evaluationLogic` COMPLETA.
    }
    // ... (Esqueletos similares para TODAS las otras actividades: exerciseActivity, problemSolvingActivity, etc.) ...

    // --- FUNCIONES DE NAVEGACI√ìN Y UI ---
    function downloadCertificate() { /* ... (Implementaci√≥n id√©ntica a la anterior) ... */ }
    const backToTopBtn = document.getElementById('backToTopBtn');
    function updateSidebarActiveLinkAndScrollButton() { /* ... (Implementaci√≥n id√©ntica) ... */ }

    // --- EVENT LISTENER PRINCIPAL (DOMContentLoaded - CON DIAGN√ìSTICO) ---
    document.addEventListener('DOMContentLoaded', () => {
        console.log("DOM Content Loaded - Iniciando l√≥gica de visibilidad...");
        loadStudentInfo(); // Carga o inicializa studentInfo
        loadProgress();    // Carga progreso o establece valores iniciales y llama a updateOverallProgress

        const coverPage = document.getElementById('coverPage');
        const moduleContainer = document.getElementById('moduleContainer');

        console.log("[DIAGN√ìSTICO] Elemento coverPage:", coverPage);
        console.log("[DIAGN√ìSTICO] Elemento moduleContainer:", moduleContainer);
        console.log("[DIAGN√ìSTICO] studentInfo.firstName:", studentInfo.firstName);
        console.log("[DIAGN√ìSTICO] Progreso guardado (localStorage):", localStorage.getItem(STORAGE_KEY_PROGRESS));

        if (studentInfo.firstName && localStorage.getItem(STORAGE_KEY_PROGRESS)) {
            console.log("[DIAGN√ìSTICO] CONDICI√ìN VERDADERA: Intentando mostrar contenido del m√≥dulo.");
            if (coverPage) { coverPage.style.display = 'none'; }
            else { console.error("Error: #coverPage no encontrado para ocultar!"); }
            
            if (moduleContainer) { moduleContainer.style.display = 'flex'; }
            else { console.error("Error: #moduleContainer no encontrado para mostrar!"); }
        } else {
            console.log("[DIAGN√ìSTICO] CONDICI√ìN FALSA: Intentando mostrar portada.");
            if (coverPage) { coverPage.style.display = 'flex'; }
            else { console.error("Error: #coverPage no encontrado para mostrar!"); }
            
            if (moduleContainer) { moduleContainer.style.display = 'none'; }
            else { console.error("Error: #moduleContainer no encontrado para ocultar (ya deber√≠a estarlo por CSS)!"); }
        }
        // Forzar una actualizaci√≥n de la barra de progreso despu√©s de decidir qu√© mostrar
        updateOverallProgress();
        updateSidebarActiveLinkAndScrollButton();

        // --- Resto de listeners e inicializaciones ---
        const elementsToReveal = document.querySelectorAll('.reveal-on-scroll');
        if (elementsToReveal.length > 0) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.05 });
            elementsToReveal.forEach(el => observer.observe(el));
        } else {
            console.warn("[DIAGN√ìSTICO] No se encontraron elementos '.reveal-on-scroll'.")
        }


        const videoThumbnailOverlay = document.querySelector('.video-thumbnail-overlay');
        const youtubeVideoIframe = document.getElementById('youtubeVideo');
        if (videoThumbnailOverlay && youtubeVideoIframe) {
            videoThumbnailOverlay.addEventListener('click', function() { /* ... (l√≥gica del video) ... */ });
        } else {
            console.warn("[DIAGN√ìSTICO] Elementos del video no encontrados (overlay o iframe).");
        }

        const initiateModuleBtn = document.getElementById('initiateModuleBtn');
        if(initiateModuleBtn) initiateModuleBtn.addEventListener('click', initiateModule);
        else console.warn("[DIAGN√ìSTICO] Bot√≥n #initiateModuleBtn no encontrado.");

        const downloadCertBtn = document.getElementById('downloadCertificateBtn');
        if(downloadCertBtn) downloadCertBtn.addEventListener('click', downloadCertificate);

        const modalCloseBtn = document.getElementById('modalCloseBtn');
        if(modalCloseBtn) modalCloseBtn.addEventListener('click', closeModal);

        if (backToTopBtn) {
            backToTopBtn.addEventListener('click', (e) => { e.preventDefault(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
        }

        document.querySelectorAll('.sidebar-nav a').forEach(anchor => {
           /* ... (l√≥gica de scroll suave del sidebar) ... */
        });
            
        console.log("MOOC Ultra Final Script: DOM completamente cargado y analizado. Listeners adjuntados.");
    });

    window.addEventListener('scroll', updateSidebarActiveLinkAndScrollButton);
    
    console.log("MOOC Ultra Final Script: Cargado (fin del script).");
    </script>
</body>
</html>
