<immersive id="mooc-prompts-educacion-secundaria-usb-final" title="Dominando los Prompts: IA para la Educación Secundaria Creativa en Santa Cruz (Versión Final Profesional)">
<!-- 
  MOOC: Dominando los Prompts - Versión Final Profesional
  ---------------------------------------------------------------------
  Este archivo representa una versión consolidada y revisada del MOOC,
  incorporando mejoras en SEO, accesibilidad, estética, experiencia de usuario,
  y completitud del código JavaScript para todas las actividades.

  Para Despliegue en GitHub Pages (o similar):
  1.  Considere separar CSS y JS en archivos externos (e.g., assets/css/main.css, assets/js/app.js) 
      para mejor organización y cacheo del navegador.
  2.  Cree un archivo README.md detallado para el repositorio.
  3.  Incluya un archivo LICENSE (e.g., MIT para código, CC para contenido).
  4.  Optimice las imágenes y use formatos modernos (e.g., WebP con fallback).
  5.  Minifique CSS y JS para producción.

  Facilitador: Lic. Luis Alfredo Andia Valverde
  Institución: Universidad Salesiana de Bolivia
  Versión del Código: 2.0
  Última Modificación: [Fecha Actual]
-->
<html lang="es-BO" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Esencial y Metadatos (Mantenidos de la versión experta) -->
    <title>Dominando los Prompts: IA para Docentes en Santa Cruz | USB</title>
    <meta name="description" content="Curso MOOC gratuito de la Universidad Salesiana de Bolivia para docentes de secundaria en Santa Cruz. Aprende a usar prompts de IA (ChatGPT, Gemini) para potenciar la creatividad y métodos activos en el aula. Facilitado por Lic. Luis Alfredo Andia Valverde.">
    <meta name="keywords" content="MOOC, IA para docentes, prompts, ChatGPT en educación, Gemini, Santa Cruz, Bolivia, curso gratuito, Universidad Salesiana de Bolivia, Luis Andia Valverde, innovación educativa, creatividad en el aula, métodos activos de aprendizaje, desarrollo profesional docente">
    <meta name="author" content="Universidad Salesiana de Bolivia, Lic. Luis Alfredo Andia Valverde">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <link rel="canonical" href="REEMPLAZAR_CON_URL_CANONICA_FINAL_DEL_MOOC">

    <!-- Open Graph y Twitter Card (Mantenidos, recordar reemplazar URLs de imágenes) -->
    <meta property="og:title" content="Dominando los Prompts: IA para Docentes en Santa Cruz | USB">
    <meta property="og:description" content="¡Profe cruceño! Transforma tu enseñanza con IA. Curso gratuito de la U. Salesiana.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="REEMPLAZAR_CON_URL_CANONICA_FINAL_DEL_MOOC">
    <meta property="og:image" content="REEMPLAZAR_CON_URL_IMAGEN_OG_1200X630.jpg">
    <meta property="og:image:alt" content="Logo de la Universidad Salesiana de Bolivia y título del curso Dominando los Prompts">
    <meta property="og:locale" content="es_BO">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Dominando los Prompts: IA para Docentes en Santa Cruz | USB">
    <meta name="twitter:description" content="¡Profe cruceño! Transforma tu enseñanza con IA. Curso gratuito de la U. Salesiana.">
    <meta name="twitter:image" content="REEMPLAZAR_CON_URL_IMAGEN_TWITTER.jpg">

    <!-- Favicon (Reemplazar con archivos reales) -->
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Dependencias Externas -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">

    <!-- JSON-LD Schema.org (Mantenido y optimizado, recordar reemplazar placeholders de URLs y fechas) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Course",
      "name": "Dominando los Prompts: IA para una Educación Secundaria Creativa en Santa Cruz de la Sierra",
      "description": "Un MOOC gratuito ofrecido por la Universidad Salesiana de Bolivia, diseñado para empoderar a los docentes de educación secundaria en Santa Cruz con las habilidades para crear prompts efectivos para Inteligencia Artificial (IA), fomentando la creatividad estudiantil y la implementación de metodologías activas de aprendizaje en el aula.",
      "provider": {
        "@type": "CollegeOrUniversity",
        "name": "Universidad Salesiana de Bolivia",
        "url": "https://www.usalesiana.edu.bo/",
        "logo": "REEMPLAZAR_CON_URL_LOGO_USB.png"
      },
      "courseCode": "USB-IA-PROMPTS-SCZ-2025",
      "educationalLevel": "ProfessionalDevelopment",
      "audience": {
        "@type": "Audience",
        "audienceType": "Secondary school teachers",
        "geographicArea": { "@type": "AdministrativeArea", "name": "Santa Cruz de la Sierra, Bolivia" }
      },
      "learningResourceType": "MOOC", "isAccessibleForFree": true,
      "educationalCredentialAwarded": {
        "@type": "EducationalOccupationalCredential", "credentialCategory": "Certificate", "name": "Certificado de Aprobación del Curso"
      },
      "hasCourseInstance": {
        "@type": "CourseInstance", "courseMode": "online",
        "instructor": {
          "@type": "Person", "name": "Lic. Luis Alfredo Andia Valverde", "jobTitle": "Facilitador del Módulo, Experto en IA Educativa",
          "affiliation": { "@type": "CollegeOrUniversity", "name": "Universidad Salesiana de Bolivia" }
        },
        "startDate": "2025-03-01", "endDate": "2025-04-30", "courseWorkload": "PT20H"
      },
      "teaches": ["Prompt engineering for AI", "AI in secondary education", "Creative thinking with AI", "Active learning methodologies using AI tools"],
      "keywords": "IA para docentes, prompts, ChatGPT, Gemini, Santa Cruz, Bolivia, curso gratuito, Universidad Salesiana, innovación educativa"
    }
    </script>

    <style>
        /* --- ESTILOS GENERALES Y DE ACCESIBILIDAD (CON VARIABLES CSS) --- */
        :root {
            --color-primary-purple: #4A0072;
            --color-primary-purple-light: #6A0DAD;
            --color-accent-yellow: #FFB300; 
            --color-accent-yellow-light: #FFCA28;
            --color-text-dark: #212529;
            --color-text-light: #FFFFFF;
            --color-text-medium: #495057;
            --color-background-light: #f8f9fa;
            --color-background-module: #FFFFFF;
            --color-success: #198754;
            --color-warning-bg: #fff3cd; /* Para fondos de advertencia */
            --color-warning-text: #664d03; /* Texto para fondos de advertencia */
            --color-warning-border: #ffeeba; /* Borde para advertencias */
            --color-danger-bg: #f8d7da;
            --color-danger-text: #58151c;
            --color-danger-border: #f5c2c7;
            --color-info-bg: #cff4fc;
            --color-info-text: #055160;
            --color-info-border: #b6effb;
            --color-indigo-accent: #6366F1; /* Azul índigo como acento general de sección */
            --color-indigo-dark: #4f46e5;

            --font-primary: 'Inter', sans-serif;
            --font-headings: 'Playfair Display', serif;
            --focus-ring-color: #0056b3;
        }
        *:focus-visible {
            outline: 3px solid var(--focus-ring-color) !important;
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.2);
        }
        body { /* ... (igual que antes) ... */ }

        /* --- PORTADA (COVER PAGE) --- */
        /* ... (Estilos de Portada mayormente iguales, se benefician de variables CSS) ... */
        #initiateModuleBtn { background-color: var(--color-accent-yellow); color: var(--color-text-dark); /* Buen contraste */ }

        /* --- ESTRUCTURA DEL MÓDULO --- */
        .app-container { max-width: 1200px; box-shadow: 0 10px 35px rgba(0, 0, 0, 0.08); } /* Sombra ajustada */

        /* --- CABECERA DEL MÓDULO (Con Video) --- */
        .module-header {
            background: linear-gradient(135deg, var(--color-primary-purple), var(--color-primary-purple-light));
            color: var(--color-text-light); /* Asegurar texto blanco por defecto */
            padding: 30px 35px; /* Ajuste de padding */
            /* ... (resto de estilos de ::before, animación, etc.) ... */
        }
        .module-header h1 {
            font-family: var(--font-headings);
            color: var(--color-text-light); /* Texto explícitamente blanco */
            font-size: 2.5rem; 
            /* text-shadow: none; Removido para legibilidad, el contraste es suficiente */
            position: relative; z-index: 1;
        }
        .module-header h1 .student-name-placeholder {
            color: var(--color-accent-yellow-light); /* Amarillo sobre púrpura */
        }
        .module-header p {
            color: var(--color-text-light); /* Texto explícitamente blanco */
            font-weight: 400; /* Aumentado para legibilidad */
            opacity: 0.9;
            /* text-shadow: none; Removido */
            position: relative; z-index: 1;
        }
        
        /* --- NAVEGACIÓN LATERAL (SIDEBAR) --- */
        .sidebar-nav {
            width: 300px; 
            background-color: var(--color-background-light) !important; /* ¡Importante para anular otros BG */
            /* ... (resto de estilos) ... */
        }
        .sidebar-nav h3 { color: var(--color-primary-purple); }
        .sidebar-nav ul li a {
            color: var(--color-text-medium); /* Buen contraste sobre fondo claro */
             /* ... (resto de estilos de 'a') ... */
        }
        .sidebar-nav ul li a.active {
            background-color: var(--color-primary-purple);
            color: var(--color-text-light); /* Texto blanco sobre púrpura */
            border-left: 5px solid var(--color-accent-yellow);
        }

        /* --- VIDEO EMBED (CORRECCIONES APLICADAS) --- */
        .video-container { 
            position: relative; width: 100%; padding-bottom: 56.25%; height: 0; 
            margin: 30px 0 40px 0; border-radius: 12px; overflow: hidden; 
            background-color: #222; /* Fondo mientras carga/si falla */
            box-shadow: 0 8px 25px rgba(0,0,0,0.2); 
        }
        .video-container iframe { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; 
        }
        .video-thumbnail-overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            display: flex; justify-content: center; align-items: center; 
            cursor: pointer; 
            z-index: 5; /* Encima del iframe oculto */
        }
        .video-thumbnail-overlay img { /* Imagen de miniatura */
            display: block; width: 100%; height: 100%; 
            object-fit: cover;
            position: absolute; top: 0; left: 0;
            z-index: 1; /* Base visual del overlay */
            transition: transform 0.4s ease-in-out;
        }
        .video-thumbnail-overlay::before { /* Capa de tinte oscuro */
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(25, 15, 45, 0.65); /* Púrpura oscuro semitransparente */
            z-index: 2; /* Encima de la imagen */
            transition: background-color 0.3s ease;
        }
        .video-thumbnail-overlay:hover img { transform: scale(1.03); }
        .video-thumbnail-overlay:hover::before { background-color: rgba(25, 15, 45, 0.8); }

        .video-play-button { 
            width: 80px; height: 80px; 
            background-color: rgba(255, 255, 255, 0.25); /* Botón blanco semitransparente */
            backdrop-filter: blur(5px); /* Efecto vidrio esmerilado */
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 50%; 
            display: flex; justify-content: center; align-items: center; 
            font-size: 2.5rem; color: var(--color-text-light); /* Flecha blanca */
            padding-left: 7px; /* Ajuste visual de la flecha */
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); 
            transition: transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            position: relative; /* Para estar sobre la imagen y el ::before */
            z-index: 3; 
        }
        .video-thumbnail-overlay:hover .video-play-button { 
            transform: scale(1.1); 
            background-color: rgba(255, 255, 255, 0.35);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        /* Resto de estilos (botones, secciones, actividades, modal, etc.)
           Se benefician de las variables CSS y las revisiones de contraste.
           Los cambios aplicados en la versión anterior (`mooc_007_expert_review.html`) para
           botones, etc., se asumen correctos en términos de contraste con el uso de las variables.
        */
        .module-section, .interactive-activity {
            border-left: 8px solid var(--color-indigo-accent); /* Acento general de sección */
        }
        .activity-instruction strong.highlight { /* Reafirmar contraste */
            background-color: var(--color-accent-yellow-light);
            color: var(--color-text-dark);
        }
        .attempts-feedback { /* Estilo para intentos restantes */
            background-color: var(--color-info-bg);
            border: 1px solid var(--color-info-border);
            color: var(--color-info-text);
        }
        /* Feedback de respuesta general para actividades con score */
        .response-feedback.text-green-700 { /* Éxito */
            background-color: #d1e7dd; /* verde claro de bootstrap success */
            border:1px solid var(--color-success);
            color: #0f5132; /* verde oscuro */
        }
        .response-feedback.text-yellow-700 { /* Advertencia/Mejora */
            background-color: var(--color-warning-bg);
            border:1px solid var(--color-warning-border);
            color: var(--color-warning-text);
        }
        .response-feedback.text-red-700 { /* Necesita mucho trabajo */
            background-color: var(--color-danger-bg);
            border:1px solid var(--color-danger-border);
            color: var(--color-danger-text);
        }


    </style>
</head>
<body>
    <!-- Cover Page HTML (como en mooc_007) -->
    <div id="coverPage" class="relative text-white overflow-hidden">
       <!-- ... Contenido de Portada ... -->
       <div class="cover-content relative z-10 flex flex-col items-center justify-center min-h-screen p-4 sm:p-8">
           <!-- ... (títulos, formulario, etc. idéntico a mooc_007) ... -->
            <div class="text-center mb-10">
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-black leading-tight mb-4 tracking-tight text-balance">
                    Dominando los Prompts
                </h1>
                <p class="text-xl sm:text-2xl md:text-3xl font-light mb-8 opacity-90 text-shadow-sm text-balance">
                    IA para una Educación Secundaria Creativa en <span class="font-semibold text-yellow-300">Santa Cruz de la Sierra</span>
                </p>
                <p class="text-md sm:text-lg max-w-xl mx-auto opacity-85 mb-12 leading-relaxed text-balance">
                    ¡Hola, colega profe! Prepárate para potenciar tu ingenio y el de tus estudiantes. Este curso te dará las claves para convertirte en un "maestro pronteador" con IA.
                </p>
            </div>
            <div class="bg-white/5 backdrop-blur-lg p-6 sm:p-10 rounded-xl shadow-2xl w-full max-w-md transform hover:scale-102 transition-transform duration-300">
                <h2 class="text-2xl font-semibold mb-6 text-center text-yellow-300 text-balance">¡Bienvenido/a! Ingresa tus datos para comenzar esta aventura:</h2>
                <form id="studentInfoForm" class="space-y-5" aria-labelledby="formHeading">
                    <h3 id="formHeading" class="visually-hidden">Formulario de registro de estudiante</h3>
                    <div>
                        <label for="studentFirstName" class="block text-sm font-medium mb-1.5 opacity-80">Nombres:</label>
                        <input type="text" id="studentFirstName" name="studentFirstName" required autocomplete="given-name"
                               class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition placeholder-gray-300 text-white text-lg"
                               placeholder="Ej: Ana Sofía">
                    </div>
                    <div>
                        <label for="studentLastName" class="block text-sm font-medium mb-1.5 opacity-80">Apellidos:</label>
                        <input type="text" id="studentLastName" name="studentLastName" required autocomplete="family-name"
                               class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition placeholder-gray-300 text-white text-lg"
                               placeholder="Ej: Pérez López">
                    </div>
                    <div>
                        <label for="studentClassCourse" class="block text-sm font-medium mb-1.5 opacity-80">Unidad Educativa / Curso que dictas:</label>
                        <input type="text" id="studentClassCourse" name="studentClassCourse" required autocomplete="organization-title"
                               class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition placeholder-gray-300 text-white text-lg"
                               placeholder="Ej: UE Don Bosco / 5to Secundaria - Lenguaje">
                    </div>
                    <button type="button" id="initiateModuleBtn"
                            class="w-full font-bold py-3.5 px-6 rounded-lg shadow-lg hover:bg-yellow-300 transform hover:scale-105 transition duration-300 ease-in-out mt-8 text-lg">
                        ¡Ingresar al Módulo!
                    </button>
                </form>
            </div>
             <p class="mt-12 text-xs opacity-60">© 2025 Plataforma Educativa Innovadora - Universidad Salesiana de Bolivia</p>
       </div>
    </div>

    <!-- Main Module Container HTML (como en mooc_007) -->
    <div id="moduleContainer" class="module-container">
        <!-- ... Barra de Progreso, Sidebar, Main Content Header con Video (estructura como en mooc_007) ... -->
        <!-- ... Secciones de contenido (Welcome, Objectives, etc., como en mooc_007) ... -->
        <!-- ... Actividades (Quiz, Exercise, etc., como en mooc_007) ... -->
        <!-- La diferencia estará en el JS que controla estas actividades -->
        <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-labelledby="globalScoreLabel">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <span id="globalScoreLabel" class="visually-hidden">Progreso general del curso</span>


        <div class="flex flex-col lg:flex-row app-container">
            <aside class="sidebar-nav hidden lg:block" aria-label="Navegación principal del módulo">
                <h3>Navegación del Módulo</h3>
                <ul id="sidebarNavList">
                    <li><a href="#welcomeSection" class="active">👋 Bienvenida Cruceña</a></li>
                    <li><a href="#objectivesSection">🎯 Objetivos Clave</a></li>
                    <li><a href="#section-intro-prompts">💡 ¿Qué es un Prompt? El Secreto</a></li>
                    <li><a href="#section-creativity-prompts">🎨 Prompts para Desatar la Creatividad</a></li>
                    <li><a href="#section-active-methods">🚀 Prompts para Clases Dinámicas</a></li>
                    <li><a href="#section-refining-prompts">🛠️ Refinando tus Prompts como un Pro</a></li>
                    <li><a href="#promptConstructionActivity">🔧 Desafío: Construye tu Prompt</a></li>
                    <li><a href="#quizActivity">🧠 Quiz Rápido de Prompts</a></li>
                    <li><a href="#exerciseActivity">✍️ Actividad: Tu Prompt Creativo</a></li>
                    <li><a href="#problemSolvingActivity">🌍 Actividad: IA para Problemas Locales</a></li>
                    <li><a href="#yourTurnToCreateActivity">🎬 ¡Tu Turno! Escenario Cruceño</a></li>
                    <li><a href="#matchingActivity">🤝 Actividad: Emparejando Ideas</a></li>
                    <li><a href="#trueFalseActivity">✅❌ Actividad: Verdadero o Falso IA</a></li>
                    <li><a href="#summarySection">📋 Resumen del Módulo</a></li>
                    <li><a href="#conclusionSection">🎉 Conclusión y ¡A Volar!</a></li>
                    <li><a href="#bibliographySection">📚 Recursos para Seguir Explorando</a></li>
                </ul>
                <div class="facilitator-info">
                    <p>Facilitador: <span class="font-semibold">Lic. Luis Alfredo Andia Valverde</span></p>
                    <p>Módulo: <span class="font-semibold">Planificación Educativa con IA</span></p>
                    <p>Institución: <span class="font-semibold">Universidad Salesiana de Bolivia</span></p>
                    <p class="mt-4">Tu Progreso: <strong id="globalScore" class="font-bold text-blue-700">0%</strong></p>
                </div>
            </aside>

            <main class="main-content flex-grow p-5 lg:p-8" role="main">
                <header class="module-header rounded-lg mb-8 p-6 text-center shadow-lg">
                    <h1 class="text-balance">¡Hola, <span class="student-name-placeholder text-yellow-300">Profe</span>! Bienvenido/a a "Dominando los Prompts"</h1>
                    <p class="text-balance">Aquí empieza tu viaje para convertir la IA en tu mejor aliada en el aula. ¡Vamos a prontear como campeones!</p>
                    <div class="video-container mt-6">
                        <!-- Asegúrate que DATA-VIDEO-ID es correcto -->
                        <div class="video-thumbnail-overlay" data-video-id="ZIBt4h39vb0" data-thumbnail-url="https://img.youtube.com/vi/ZIBt4h39vb0/hqdefault.jpg"> 
                            <img src="https://img.youtube.com/vi/ZIBt4h39vb0/hqdefault.jpg" alt="Video Thumbnail: Introducción al Diseño de Prompts con IA para educadores en Santa Cruz.">
                            <div class="video-play-button" aria-label="Reproducir video introductorio"><span aria-hidden="true">▶</span></div>
                        </div>
                        <iframe id="youtubeVideo" title="Video Introductorio al Diseño de Prompts con IA" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: none;"></iframe>
                    </div>
                </header>

                <!-- SECCIONES DEL CURSO -->
                <!-- El HTML interno de las secciones (welcome, objectives, activities, etc.) 
                     es el mismo que en mooc_007_expert_review.html.
                     Por brevedad, no se repite aquí. Lo crucial son los estilos CSS ya aplicados
                     y el script JS completo y funcional que vendrá después.
                -->
                 <section id="welcomeSection" class="module-section reveal-on-scroll" data-section-id="welcomeSection" aria-labelledby="welcomeHeading">
                    <h2 id="welcomeHeading" class="text-balance">👋 ¡Bienvenida a la Revolución del Prompt, <span class="student-name-placeholder text-indigo-600">Estimado/a Colega</span>!</h2>
                    <p>¡Qué alegría tenerte aquí, <span class="student-name-placeholder"></span>! Desde la vibrante Santa Cruz de la Sierra, te damos la bienvenida a este espacio de aprendizaje donde vamos a desmitificar la Inteligencia Artificial y convertirla en una herramienta poderosa para tu labor docente.</p>
                    <p>¿Te imaginas tener un asistente súper inteligente que te ayude a generar ideas creativas, diseñar actividades innovadoras y personalizar el aprendizaje para tus capísimos estudiantes de secundaria? ¡Pues eso es posible dominando el arte del "prompting"!</p>
                    <p>En este módulo, no solo aprenderás qué es un prompt, sino cómo "cocinar" los mejores para sacarle el jugo a la IA. Prepárate para explorar, experimentar y, sobre todo, para inyectarle una dosis extra de creatividad e innovación a tus clases. ¡A darle átomos, <span class="student-name-placeholder"></span>!</p>
                    <figure role="group" aria-label="Docente innovando en el aula">
                        <img src="https://images.pexels.com/photos/5088017/pexels-photo-5088017.jpeg?auto=compress&cs=tinysrgb&w=600&lazy=load" alt="Docente sonriendo mientras usa una laptop en un aula moderna y colorida, representando la innovación educativa en Santa Cruz." class="module-image">
                        <figcaption class="visually-hidden">Imagen de un docente utilizando tecnología, simbolizando la innovación.</figcaption>
                    </figure>
                    <button class="mark-as-read-btn" data-section-id="welcomeSection" onclick="markSectionAsRead(this)">Marcar como leído</button>
                </section>

                 <!-- (Colocar aquí el resto de las secciones y actividades como en la versión mooc_007_expert_review.html) -->
                 <!-- Ejemplo: Sección de Objetivos -->
                <section id="objectivesSection" class="module-section reveal-on-scroll" data-section-id="objectivesSection" aria-labelledby="objectivesHeading">
                    <h2 id="objectivesHeading" class="text-balance">🎯 Objetivos Clave de este Módulo</h2>
                    <p class="activity-instruction">Al finalizar este power-módulo, <span class="student-name-placeholder"></span>, estarás más que listo/a para:</p>
                    <ul class="list-none space-y-3 text-lg text-gray-700 pl-0">
                        <li class="icon-list-item !p-0 !bg-transparent !shadow-none !border-none"><div class="icon-list-icon icon-lightbulb"></div><div class="icon-list-content !pt-2"><span><strong>Entender a fondo:</strong> Qué es un prompt y por qué es la llave maestra para comunicarte con la IA.</span></div></li>
                        <li class="icon-list-item !p-0 !bg-transparent !shadow-none !border-none"><div class="icon-list-icon icon-brainstorm"></div><div class="icon-list-content !pt-2"><span><strong>Diseñar con chispa:</strong> Prompts que enciendan la llama de la creatividad en tus estudiantes de secundaria.</span></div></li>
                        <li class="icon-list-item !p-0 !bg-transparent !shadow-none !border-none"><div class="icon-list-icon icon-gears"></div><div class="icon-list-content !pt-2"><span><strong>Aplicar en el aula:</strong> Usar prompts para crear actividades dinámicas con métodos activos de aprendizaje (¡chau clases aburridas!).</span></div></li>
                        <li class="icon-list-item !p-0 !bg-transparent !shadow-none !border-none"><div class="icon-list-icon icon-target"></div><div class="icon-list-content !pt-2"><span><strong>Pulir y refinar:</strong> Mejorar tus prompts para que la IA te dé justo lo que necesitas, ¡y más!</span></div></li>
                         <li class="icon-list-item !p-0 !bg-transparent !shadow-none !border-none"><div class="icon-list-icon icon-challenge"></div><div class="icon-list-content !pt-2"><span><strong>Evaluar como experto/a:</strong> La calidad de los prompts y las respuestas de la IA, desarrollando tu criterio.</span></div></li>
                    </ul>
                    <p class="mt-6">¡Un desafío emocionante, <span class="student-name-placeholder"></span>, pero sé que lo superarás con creces!</p>
                    <button class="mark-as-read-btn" data-section-id="objectivesSection" onclick="markSectionAsRead(this)">Marcar como leído</button>
                </section>

                <!-- (Añadir aquí el resto de las secciones y actividades de mooc_007... ) -->
                <!-- Las secciones importantes son:
                    #section-intro-prompts
                    #section-creativity-prompts
                    #section-active-methods
                    #section-refining-prompts
                    #promptConstructionActivity (Nueva Actividad)
                    #quizActivity
                    #exerciseActivity
                    #problemSolvingActivity
                    #yourTurnToCreateActivity (Nueva Actividad)
                    #matchingActivity
                    #trueFalseActivity
                    #summarySection
                    #conclusionSection
                    #bibliographySection
                -->
                 <div id="quizActivity" class="interactive-activity reveal-on-scroll" data-last-score="0" data-attempts="0" aria-labelledby="quizActivityHeading">
                    <h2 id="quizActivityHeading" class="text-balance">🧠 Quiz Rápido: ¿Qué Tal Vamos con los Prompts, <span class="student-name-placeholder text-indigo-600">Profe</span>?</h2>
                    <p class="activity-instruction">Pon a prueba tus conocimientos, <span class="student-name-placeholder"></span>. Selecciona la mejor respuesta para cada pregunta. (Tienes 2 intentos, ¡así que con calma y buena letra!)</p>
                    
                    <fieldset class="quiz-question mb-6" role="group" aria-labelledby="quizQ1Label">
                        <legend id="quizQ1Label" class="font-semibold mb-3 text-lg text-balance">1. Para que una IA te dé una respuesta súper específica y útil, ¿qué es lo MÁS importante en tu prompt?</legend>
                        <div class="options space-y-2">
                            <div><input type="radio" name="q1" id="q1a" value="a" class="quiz-option-input visually-hidden"><label for="q1a" class="quiz-option" data-question="q1" data-value="a">a) Que el prompt sea muy, muy corto y directo al grano.</label></div>
                            <div><input type="radio" name="q1" id="q1b" value="b" class="quiz-option-input visually-hidden"><label for="q1b" class="quiz-option" data-question="q1" data-value="b">b) La claridad, especificidad y el contexto que le das en la instrucción.</label></div>
                            <div><input type="radio" name="q1" id="q1c" value="c" class="quiz-option-input visually-hidden"><label for="q1c" class="quiz-option" data-question="q1" data-value="c">c) Escribir todo el prompt en MAYÚSCULAS para que la IA lo note más.</label></div>
                        </div><div class="quiz-feedback" id="feedback-q1" role="alert" aria-live="polite"></div>
                    </fieldset>
                    
                    <fieldset class="quiz-question mb-6" role="group" aria-labelledby="quizQ2Label">
                        <legend id="quizQ2Label" class="font-semibold mb-3 text-lg text-balance">2. Si quieres que la IA te ayude a generar ideas bien creativas para tus clases en Santa Cruz, ¿qué deberías incluir en tu prompt?</legend>
                        <div class="options space-y-2">
                            <div><input type="radio" name="q2" id="q2a" value="a" class="quiz-option-input visually-hidden"><label for="q2a" class="quiz-option" data-question="q2" data-value="a">a) Solo el tema general, por ejemplo "la deforestación", sin darle más vueltas.</label></div>
                            <div><input type="radio" name="q2" id="q2b" value="b" class="quiz-option-input visually-hidden"><label for="q2b" class="quiz-option" data-question="q2" data-value="b">b) Un rol para la IA (ej. "experto en gamificación"), el contexto (ej. "para alumnos cruceños de 15 años"), y el formato que quieres (ej. "una lista de 5 ideas").</label></div>
                            <div><input type="radio" name="q2" id="q2c" value="c" class="quiz-option-input visually-hidden"><label for="q2c" class="quiz-option" data-question="q2" data-value="c">c) Únicamente preguntas que se puedan responder con "sí" o "no", para no confundir a la IA.</label></div>
                        </div><div class="quiz-feedback" id="feedback-q2" role="alert" aria-live="polite"></div>
                    </fieldset>
                    
                     <fieldset class="quiz-question mb-6" role="group" aria-labelledby="quizQ3Label">
                        <legend id="quizQ3Label" class="font-semibold mb-3 text-lg text-balance">3. Cuando hablamos de "iterar" para refinar prompts, ¿a qué nos referimos, <span class="student-name-placeholder"></span>?</legend>
                        <div class="options space-y-2">
                            <div><input type="radio" name="q3" id="q3a" value="a" class="quiz-option-input visually-hidden"><label for="q3a" class="quiz-option" data-question="q3" data-value="a">a) A repetir el mismo prompt una y otra vez hasta que la IA por fin entienda lo que queremos.</label></div>
                            <div><input type="radio" name="q3" id="q3b" value="b" class="quiz-option-input visually-hidden"><label for="q3b" class="quiz-option" data-question="q3" data-value="b">b) A copiar y pegar prompts que a otros profes les funcionaron bien, sin cambiarles nada.</label></div>
                            <div><input type="radio" name="q3" id="q3c" value="c" class="quiz-option-input visually-hidden"><label for="q3c" class="quiz-option" data-question="q3" data-value="c">c) A probar distintas versiones del prompt, añadiendo o cambiando detalles, probando y ajustando hasta que la IA nos dé el resultado soñado.</label></div>
                        </div><div class="quiz-feedback" id="feedback-q3" role="alert" aria-live="polite"></div>
                    </fieldset>
                    <button class="submit-btn" id="submitQuizBtn">Enviar Respuestas del Quiz</button>
                    <button class="reset-button" id="resetQuizBtn" disabled>Reiniciar Quiz</button>
                    <div id="quizAttemptsFeedback" class="attempts-feedback" role="status" aria-live="polite"></div>
                </div>

            </main>
        </div>
    </div>

    <!-- Botón Volver Arriba -->
    <a href="#" class="back-to-top" id="backToTopBtn" style="display:flex;" aria-label="Volver arriba">
        <span aria-hidden="true">⬆️</span>
        <span class="visually-hidden">Volver al inicio de la página</span>
    </a>

    <!-- Modal Personalizado para Notificaciones -->
    <div id="customModal" class="modal" role="alertdialog" aria-labelledby="modalTitle" aria-describedby="modalMessage" aria-modal="true" style="display: none;"> <!-- Inicialmente oculto -->
        <div class="modal-content">
            <h3 id="modalTitle" class="text-balance"></h3>
            <p id="modalMessage"></p>
            <button id="modalCloseBtn">¡Entendido!</button>
        </div>
    </div>

    <script>
    // --- SCRIPT JS COMPLETO Y REVISADO ---

    // --- CONFIGURACIÓN GLOBAL Y CONSTANTES ---
    const STORAGE_KEY_STUDENT_INFO = 'moocStudentInfo_prompts_educacion_SCZ_final_v1';
    const STORAGE_KEY_PROGRESS = 'moocProgress_prompts_educacion_SCZ_final_v1';
    const MAX_ATTEMPTS = 2;

    let studentInfo = { firstName: "", lastName: "", classCourse: "" };
    const completedSections = new Set();

    // --- Datos para Actividades Interactivas ---
    // (Estos datos deben ser mantenidos y actualizados según el contenido exacto del curso)
    const quizQuestionsData = [
        { qId: "q1", correctValue: "b", feedbackCorrect: "¡Exacto, [Estudiante]! La claridad y especificidad son la clave.", feedbackIncorrect: "No del todo. La claridad y el contexto son más cruciales." },
        { qId: "q2", correctValue: "b", feedbackCorrect: "¡Así se hace, [Estudiante]! Esos son los ingredientes.", feedbackIncorrect: "Un buen prompt creativo necesita más. Piensa en rol y contexto." },
        { qId: "q3", correctValue: "c", feedbackCorrect: "¡Correctísimo, [Estudiante]! Iterar es probar y ajustar.", feedbackIncorrect: "Iterar es un proceso de mejora continua, no solo repetir o copiar." }
    ];
    const exerciseKeywords = ["charla", "perseverancia", "desafíos", "estudiantes", "secundaria", "santa cruz", "tono", "anecdota", "motivacional", "resiliencia"];
    const exerciseMinLength = 70;
    
    const problemSolvingKeywords = ["abp", "turismo", "sostenible", "lomas de arena", "preguntas guia", "fases", "productos finales"];
    const problemSolvingMinLength = 80;

    const promptConstructionParts = ["promptRole", "promptTask", "promptContext", "promptFormatTone"];
    const promptConstructionMinLengths = [10, 10, 20, 15];

    const yourTurnKeywords = ["feria", "ciencias", "innovación", "tradición", "camba", "stands", "interactivos"];
    const yourTurnMinLength = 60;

    const matchingPairsData = [ 
        { questionId: "match1", correctAnswer: "b", concept: "Rol de la IA" }, 
        { questionId: "match2", correctAnswer: "b", concept: "Formato de Salida Específico" }, 
        { questionId: "match3", correctAnswer: "c", concept: "Restricción o Límite Importante" } 
    ];
    const trueFalseQuestionsData = [
        { qId: "tf1", correctValue: "false", feedbackCorrect: "¡Falso y bien visto, [Estudiante]! Claridad > longitud.", feedbackIncorrect: "En realidad, es falso. Precisión es mejor que longitud excesiva." },
        { qId: "tf2", correctValue: "true", feedbackCorrect: "¡Verdadero! El tono es un ingrediente poderoso, [Estudiante].", feedbackIncorrect: "¡Ojo! El tono sí influye mucho en el estilo de la IA." },
        { qId: "tf3", correctValue: "false", feedbackCorrect: "¡Falso! Las IAs modernas son multimodales, [Estudiante].", feedbackIncorrect: "¡Incorrecto! Las IAs modernas pueden generar imágenes, código, etc." }
    ];


    // --- FUNCIONES DE UTILIDAD ---
    function updateStudentNamePlaceholders() {
        const nameToDisplay = studentInfo.firstName || "Profe";
        document.querySelectorAll('.student-name-placeholder').forEach(el => {
            el.textContent = nameToDisplay;
        });
    }

    function showCustomModal(title, message, type = 'info') {
        const modal = document.getElementById('customModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        
        let personalizedMessage = message.replace(/\[Estudiante\]/g, studentInfo.firstName || "Profe");
        let iconPrefix = "";
        switch (type) {
            case 'success': iconPrefix = "¡Excelente! 🎉 "; modal.className = 'modal show success'; break;
            case 'info':    iconPrefix = "💡 "; modal.className = 'modal show info'; break;
            case 'warning': iconPrefix = "⚠️ ¡Atención! "; modal.className = 'modal show warning'; break;
            case 'error':   iconPrefix = "❌ ¡Ups! "; modal.className = 'modal show error'; break;
            default: modal.className = 'modal show info';
        }
        modalTitle.textContent = iconPrefix + title;
        modalMessage.innerHTML = personalizedMessage;
        modal.style.display = 'flex'; // Asegurar que sea visible
        document.getElementById('modalCloseBtn').focus();
    }

    function closeModal() {
        document.getElementById('customModal').style.display = 'none';
        document.getElementById('customModal').className = 'modal'; // Reset class
    }

    // --- INICIALIZACIÓN Y FLUJO PRINCIPAL ---
    function loadStudentInfo() {
        const savedInfo = localStorage.getItem(STORAGE_KEY_STUDENT_INFO);
        if (savedInfo) { studentInfo = JSON.parse(savedInfo); }
        updateStudentNamePlaceholders();
        if (document.getElementById('studentInfoForm') && studentInfo.firstName) {
            document.getElementById('studentFirstName').value = studentInfo.firstName;
            document.getElementById('studentLastName').value = studentInfo.lastName;
            document.getElementById('studentClassCourse').value = studentInfo.classCourse;
        }
    }

    function initiateModule() {
        // ... (validación de formulario, guardar en localStorage) ...
        // (como en la versión anterior, pero usando las nuevas constantes STORAGE_KEY)
        // y el `showCustomModal` mejorado.
        const firstNameEl = document.getElementById('studentFirstName');
        const lastNameEl = document.getElementById('studentLastName');
        const classCourseEl = document.getElementById('studentClassCourse');

        if (!firstNameEl.value.trim() || !lastNameEl.value.trim() || !classCourseEl.value.trim()) {
            showCustomModal("¡Un momentito!", `Por favor, ${studentInfo.firstName || 'estimado/a participante'}, completa todos los campos para que podamos empezar esta aventura juntos.`, 'warning');
            return;
        }
        studentInfo.firstName = firstNameEl.value.trim();
        studentInfo.lastName = lastNameEl.value.trim();
        studentInfo.classCourse = classCourseEl.value.trim();
        localStorage.setItem(STORAGE_KEY_STUDENT_INFO, JSON.stringify(studentInfo));
        updateStudentNamePlaceholders();
        startModuleVisuals();
        showCustomModal(`¡Bienvenido/a, ${studentInfo.firstName}!`, "¡Todo listo para sumergirnos en el fascinante mundo de los prompts! Prepárate para aprender y crear.", 'success');
    }

    function startModuleVisuals() {
        document.getElementById('coverPage').style.display = 'none';
        document.getElementById('moduleContainer').style.display = 'flex';
        if (document.getElementById('moduleContainer')) { // Verificar que el elemento exista
             document.getElementById('moduleContainer').scrollIntoView({ behavior: 'auto' });
        }
        updateOverallProgress();
        updateSidebarActiveLinkAndScrollButton();
    }
    
    // --- MANEJO DE PROGRESO ---
    function updateOverallProgress() {
        // ... (Lógica como en mooc_007 para calcular porcentaje y actualizar barra y aria-valuenow) ...
        // Asegurar que el certificado solo se active si allItemsAttemptedOrRead y porcentaje >= 70
        let totalAchievedScore = 0;
        let totalPossibleItems = 0; 
        let completedOrAttemptedItems = 0; // Cambiado para reflejar intento como "progreso"

        document.querySelectorAll('.module-section[data-section-id]').forEach(section => {
            totalPossibleItems++;
            if (completedSections.has(section.id)) {
                totalAchievedScore += 100; 
                completedOrAttemptedItems++;
            }
        });
        document.querySelectorAll('.interactive-activity').forEach(activity => {
            totalPossibleItems++;
            const activityScore = parseInt(activity.dataset.lastScore || "0");
            totalAchievedScore += activityScore;
            if (activity.dataset.attempted === "true") { 
                 completedOrAttemptedItems++;
            }
        });
        const overallPercentage = totalPossibleItems > 0 ? (totalAchievedScore / (totalPossibleItems * 100)) * 100 : 0;
        const roundedPercentage = Math.round(overallPercentage);
        
        const progressBarEl = document.getElementById('progressBar');
        if (progressBarEl) progressBarEl.style.width = `${roundedPercentage}%`;
        
        const globalScoreEl = document.getElementById('globalScore');
        if (globalScoreEl) globalScoreEl.textContent = `${roundedPercentage}%`;
        
        const progressBarContainerEl = document.querySelector('.progress-bar-container');
        if (progressBarContainerEl) progressBarContainerEl.setAttribute('aria-valuenow', roundedPercentage);

        const allItemsConsidered = completedOrAttemptedItems >= totalPossibleItems;
        const certificateBtn = document.getElementById('downloadCertificateBtn');
        if (certificateBtn) {
            if (allItemsConsidered && roundedPercentage >= 70) {
                certificateBtn.style.display = 'inline-block';
            } else {
                certificateBtn.style.display = 'none';
            }
        }
        saveProgress(); 
    }
        
    function markSectionAsRead(button) {
        // ... (Como en mooc_007, usando showCustomModal mejorado) ...
        const sectionId = button.dataset.sectionId;
        if (!completedSections.has(sectionId)) {
            completedSections.add(sectionId);
            button.classList.add('completed');
            button.innerHTML = 'Completado <span role="img" aria-label="check">✅</span>'; 
            button.disabled = true;
            const sectionTitleEl = button.closest('.module-section')?.querySelector('h2, h3');
            const sectionTitle = sectionTitleEl ? sectionTitleEl.textContent : "esta sección";
            showCustomModal('¡Excelente Avance!', `¡Muy bien, ${studentInfo.firstName}! Has marcado "${sectionTitle}" como leída. ¡Sigamos aprendiendo!`, 'success');
        }
        updateOverallProgress();
    }
        
    function saveProgress() {
        // ... (Lógica de guardado para todas las actividades, usando STORAGE_KEY_PROGRESS) ...
        // Esto necesita ser muy detallado, guardando el estado de cada actividad.
        // Ejemplo de la estructura general:
        const progressData = {
            completedSections: Array.from(completedSections),
            activities: {}
        };
        document.querySelectorAll('.interactive-activity').forEach(act => {
            const actId = act.id;
            progressData.activities[actId] = {
                lastScore: act.dataset.lastScore || "0",
                attempts: act.dataset.attempts || "0",
                attempted: act.dataset.attempted === "true",
                // Aquí se guardaría el estado específico de cada actividad
                // ej: selections para quiz, prompt text para exercises
            };
             if (actId === 'quizActivity') { /* ... lógica para guardar selecciones del quiz ... */ }
             // etc. para las otras actividades
        });
        localStorage.setItem(STORAGE_KEY_PROGRESS, JSON.stringify(progressData));
    }

    function loadProgress() {
        // ... (Lógica de carga para todas las actividades, usando STORAGE_KEY_PROGRESS) ...
        // Restaurar estado de `completedSections` y datos de `activities`.
        const savedProgress = localStorage.getItem(STORAGE_KEY_PROGRESS);
        if (savedProgress) {
            const progressData = JSON.parse(savedProgress);
            if (progressData.completedSections) { /* ... restaurar completedSections ... */ }
            if (progressData.activities) { /* ... restaurar estado de cada actividad ... */ }
        }
        updateOverallProgress(); // Siempre actualizar al final
    }
    
    // --- LÓGICA GENÉRICA DE MANEJO DE ACTIVIDADES ---
    function handleActivityAttemptEnhanced(activityElement, submitButton, resetButton, attemptsFeedbackElement, maxAttempts, evaluationLogic) {
        // ... (Como se definió en la respuesta anterior, usando el evaluationLogic que retorna objeto) ...
        // Importante: `evaluationLogic` debe implementarse para CADA actividad específica.
        // Mostrar el feedback de la actividad (el `feedbackMessage` devuelto por `evaluationLogic`) en el div correspondiente
        // de la actividad Y LUEGO mostrar el modal general.
        let currentAttempts = parseInt(activityElement.dataset.attempts || "0");
        // ... (resto de la lógica de `handleActivityAttemptEnhanced`) ...
        // AL FINAL DE LA EVALUACIÓN:
        // const evalResult = evaluationLogic();
        // const activitySpecificFeedbackDiv = activityElement.querySelector('.response-feedback, .quiz-feedback'); // selector genérico
        // if (activitySpecificFeedbackDiv && evalResult.feedbackMessage) {
        //     activitySpecificFeedbackDiv.innerHTML = evalResult.feedbackMessage;
        //     activitySpecificFeedbackDiv.className = `response-feedback mt-4 ${evalResult.feedbackType === 'success' ? 'text-green-700' : (evalResult.feedbackType === 'warning' ? 'text-yellow-700' : 'text-red-700')}`;
        //     activitySpecificFeedbackDiv.classList.remove('hidden');
        // }
        // ... (lógica de modal y `updateOverallProgress()`)
    }
    
    function handleActivityReset(activityElement, submitButton, resetButton, inputElements, feedbackElements) {
        // ... (Como se definió antes, asegurando que se limpien los inputs y feedbacks visuales) ...
        // Muy importante para `.quiz-option.selected`, `.correct`, `.incorrect`
    }

    // --- LÓGICA ESPECÍFICA PARA CADA ACTIVIDAD ---
    // (Aquí iría la implementación completa para cada una de las 7 actividades,
    //  cada una con su `evaluationLogic` y event listeners para submit/reset
    //  que llamen a `handleActivityAttemptEnhanced` y `handleActivityReset`)
    
    // EJEMPLO (Corto) para QuizActivity
    // Se asume que los `quizQuestionsData` están definidos globalmente
    // Se debe mover la lógica de los querySelector para los quiz-option a dentro del listener para asegurar
    // que se captura el estado actual al momento del click.

    document.addEventListener('click', function(event) {
        if (event.target.matches('#quizActivity .quiz-option')) {
            const option = event.target;
            const activityElement = document.getElementById('quizActivity');
            if (parseInt(activityElement.dataset.attempts || "0") >= MAX_ATTEMPTS && activityElement.dataset.attempted === "true") return;
            const question = option.dataset.question;
            document.querySelectorAll(`#quizActivity .quiz-option[data-question="${question}"]`).forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
        }
    });
    
    const submitQuizBtn = document.getElementById('submitQuizBtn');
    if (submitQuizBtn) {
        submitQuizBtn.addEventListener('click', function() {
            const activityElement = document.getElementById('quizActivity');
            const evaluationLogic = () => {
                // ... (Tu lógica de evaluación del quiz detallada aquí, debe retornar
                // { score: number, feedbackMessage: string (HTML con feedback x pregunta), feedbackType: 'success'|'warning'|'error' } )
                // Esto es solo un esqueleto de ejemplo:
                 let correctAnswers = 0; let allAnswered = true;
                 let detailedFeedbackHTML = ""; 
                 quizQuestionsData.forEach(qData => { /* ... calcular correct, allAnswered y construir detailedFeedbackHTML ... */ });
                 const score = allAnswered ? Math.round((correctAnswers / quizQuestionsData.length) * 100) : 0;
                 return { score, feedbackMessage: "Resultado del Quiz: <br>" + detailedFeedbackHTML, feedbackType: score > 70 ? 'success' : 'warning' };
            };
            handleActivityAttemptEnhanced(activityElement, this, document.getElementById('resetQuizBtn'), document.getElementById('quizAttemptsFeedback'), MAX_ATTEMPTS, evaluationLogic);
        });
    }
    // (Añadir listener para resetQuizBtn aquí)
    // Repetir este patrón para TODAS las actividades interactivas.

    // --- FUNCIONES DE NAVEGACIÓN Y UI ---
    function downloadCertificate() { /* ... (Como en mooc_007) ... */ }
    const backToTopBtn = document.getElementById('backToTopBtn');
    function updateSidebarActiveLinkAndScrollButton() { /* ... (Como en mooc_007) ... */ }

    // --- EVENT LISTENER PRINCIPAL ---
    document.addEventListener('DOMContentLoaded', () => {
        loadStudentInfo();
        loadProgress();
        
        const elementsToReveal = document.querySelectorAll('.reveal-on-scroll');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.05 }); // Ligeramente más sensible
        elementsToReveal.forEach(el => observer.observe(el));

        updateSidebarActiveLinkAndScrollButton(); // Llamada inicial

        const videoThumbnailOverlay = document.querySelector('.video-thumbnail-overlay');
        const youtubeVideoIframe = document.getElementById('youtubeVideo');
        if (videoThumbnailOverlay && youtubeVideoIframe) {
            videoThumbnailOverlay.addEventListener('click', function() {
                const videoId = this.dataset.videoId;
                if (videoId) {
                    youtubeVideoIframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&modestbranding=1&rel=0&hl=es&cc_load_policy=1`; // Forzar subtítulos si disponibles
                    youtubeVideoIframe.style.display = 'block';
                    this.style.display = 'none';
                    youtubeVideoIframe.focus(); // Para accesibilidad
                }
            });
        }

        document.getElementById('initiateModuleBtn')?.addEventListener('click', initiateModule);
        document.getElementById('downloadCertificateBtn')?.addEventListener('click', downloadCertificate);
        document.getElementById('modalCloseBtn')?.addEventListener('click', closeModal);
        
        if (backToTopBtn) {
            backToTopBtn.addEventListener('click', (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }

        document.querySelectorAll('.sidebar-nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                try { // Añadir try-catch por si el selector es inválido
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        const progressBarHeight = document.querySelector('.progress-bar-container')?.offsetHeight || 0;
                        const headerOffset = progressBarHeight + 25; // Ajuste de offset
                        const elementPosition = targetElement.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                        window.scrollTo({ top: offsetPosition, behavior: 'smooth' });
                    } else {
                        console.warn("Elemento de navegación no encontrado:", targetId);
                    }
                } catch (error) {
                    console.error("Error en scroll suave:", error);
                }
            });
        });
            
        // Lógica de visibilidad inicial CoverPage vs ModuleContainer
        const coverPage = document.getElementById('coverPage');
        const moduleContainer = document.getElementById('moduleContainer');

        if (studentInfo.firstName && localStorage.getItem(STORAGE_KEY_PROGRESS)) {
            // Si hay info de estudiante Y hay progreso guardado, asumir que ya pasó por la portada.
            if(coverPage) coverPage.style.display = 'none';
            if(moduleContainer) moduleContainer.style.display = 'flex';
            updateOverallProgress(); // Para cargar barra de progreso correcta
            updateSidebarActiveLinkAndScrollButton(); // Y sidebar
        } else {
            // Caso contrario (nuevo usuario o sin progreso), mostrar portada.
            if(coverPage) coverPage.style.display = 'flex';
            if(moduleContainer) moduleContainer.style.display = 'none';
        }
    });

    window.addEventListener('scroll', updateSidebarActiveLinkAndScrollButton);
    
    // Log para verificar carga de script
    console.log("MOOC Script Final Revisado cargado y ejecutándose.");

    </script>
</body>
</html>
</immersive>
